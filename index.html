<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Mamimis Love</title>
<style>
  :root{
    --polaroid:#fafafa;
    --ink:#111;
    --shadow: rgba(0,0,0,.35);
    --pulse:#ffd1d1;
  }
  *{ box-sizing:border-box; }
  html,body{ height:100%; }
  body{
    margin:0;
    font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Inter, "Helvetica Neue", Arial;
    background:#000000; /* hidden by video */
    color:#e7e7e7;
  }

  body::after {
  content:"";
  position: fixed;
  inset: 0;
  pointer-events: none;
  background: radial-gradient(circle at center, transparent 50%, rgba(0,0,0,0.5) 100%);
  mix-blend-mode: multiply;
  z-index: 2;
}

/* Background wrapper with scanline overlay */
#bg-wrap {
  position: fixed;
  top: 0; left: 0;
  width: 100vw;
  height: 100vh;
  overflow: hidden;
  z-index: 0;
}

#light-leak {
  position: fixed;
  inset: 0;
  object-fit: cover;
  mix-blend-mode: screen;
  opacity: 0.15;
  pointer-events: none;
  z-index: 2;
  filter: saturate(1.3) brightness(1.1);
}

#bg-video {
  position: absolute;
  top: 0; left: 0;
  width: 100%;
  height: 100%;
  object-fit: cover;
  filter: brightness(.58) contrast(1.08);
  pointer-events: none;
}

/* ✅ Overlay now works because it's on a DIV, not a video */
#bg-wrap::after {
  content: "";
  position: absolute;
  inset: 0;
  pointer-events: none;
  background: repeating-linear-gradient(
    to bottom,
    rgba(0, 0, 0, 0.35) 0px,
    rgba(0, 0, 0, 0.25) 1px,
    transparent 2px,
    transparent 3px
  );
  mix-blend-mode: multiply;
  opacity: 0.4;
  z-index: 1;
  animation: flicker 2.5s ease-in-out infinite, jitter 0.5s steps(2) infinite;
}

@keyframes flicker {
  0%, 100% { opacity: 0.4; }
  50% { opacity: 0.45; }
}

@keyframes jitter {
  0%, 100% { transform: translateX(0); }
  50% { transform: translateX(2px); }
}



  /* Scrollable viewport */
  .scrollport{
    position:relative;
    width:100%; height:100%;
    object-fit: cover;
    overflow:auto;               /* both axes */
    overscroll-behavior:none;
    z-index:1;
    background: transparent; /* remove gradient to see video */
  }

  /* Big finite world */
  .world{
    position:relative;
    width:5000px;   /* tweak me */
    height:5000px;   /* tweak me */
  }

  /* 3D scene */
  .scene{ position:relative; width:100%; height:100%; perspective:1200px; }
  .floor{
    position:absolute; inset:0;
    transform-style:preserve-3d;
    transition:transform 200ms ease;
    will-change:transform;
  }

  /* Atmosphere */
  .grain::before{
    content:""; position:absolute; inset:-10%;
    background:
      rgba(0,0,0,.32), /* flat tint so the board is fully covered */
      repeating-linear-gradient(0deg, rgba(255,255,255,.02) 0 2px, transparent 2px 4px);
    pointer-events:none; mix-blend-mode:overlay;
  }
  .sweep{
    position:absolute; inset:-20%;
    background: radial-gradient(60vw 60vh at var(--sx,-30%) var(--sy,50%), rgba(255,255,255,.05), transparent 60%);
    mix-blend-mode:screen; pointer-events:none;
    animation:sweep 5.5s linear infinite;
  }
  @keyframes sweep{
    0%{ --sx:-30%; --sy:55%; } 50%{ --sx:130%; --sy:45%; } 100%{ --sx:-30%; --sy:55%; }
  }

/* === Polaroid Styling === */
.polaroid {
  position: absolute;
  width: clamp(160px, 18vw, 260px);
  aspect-ratio: 3 / 4;
  background: var(--polaroid);
  border-radius: 6px;
  box-shadow: 0 8px 16px var(--shadow),
              0 1px 0 rgba(255,255,255,.6) inset;
  padding: 10px 10px 34px;
  transform-origin: 50% 60%;
  cursor: grab;
  user-select: none;
  touch-action: none; /* ✅ essential for dragging */
  pointer-events: auto; /* ✅ ensures polaroid can receive pointer events */
  transition: box-shadow 200ms ease, filter 200ms ease;
  will-change: transform, box-shadow;
  transform: translate3d(0,0,0);
}

.polaroid:hover {
  box-shadow: 0 12px 28px rgba(0,0,0,.45),
              0 0 0 2px rgba(255,255,255,.25) inset,
              0 0 20px -6px var(--pulse);
  filter: brightness(1.05);
}

.polaroid.dragging {
  transition: none !important;
  cursor: grabbing;
}

.polaroid img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  display: block;
  border-radius: 4px;
  pointer-events: none;
}

.polaroid .caption {
  position: absolute;
  left: 0;
  right: 0;
  bottom: 6px;
  height: 24px;
  line-height: 24px;
  text-align: center;
  font-size: 12px;
  color: var(--ink);
  opacity: .75;
  pointer-events: none;
}

.grain,
.sweep {
  pointer-events: none !important; /* ✅ so they never block clicks */
}


  

</style>
</head>
<body>

  <!-- Background video -->
  <div id="bg-wrap">
    <video id="bg-video light-leak" autoplay muted loop playsinline>
      <source src="assets/video/samejima.art.mp4" type="video/mp4" />
    </video>
  </div>



  <!-- Scrollable world -->
  <div class="scrollport" id="scrollport">
    <div class="world" id="world">
      <div class="scene">
        <div class="floor grain" id="floor"></div>
        <div class="sweep"></div>
      </div>
    </div>
  </div>

<script>
document.addEventListener('DOMContentLoaded', () => {
/* ===========================
   0) CONFIG 
   =========================== */
const IMAGES = [
  { src:"https://external-content.duckduckgo.com/iu/?u=https%3A%2F%2Fstatic.zerochan.net%2FSamejima.Mamimi.full.4023034.jpg&f=1&nofb=1&ipt=9b2fc995b8ac367faeb137b1a46caac2a1709d58ed289d85edb073eccbdf907e", caption:"guitar smoke" },
  { src:"https://external-content.duckduckgo.com/iu/?u=https%3A%2F%2Fs1.zerochan.net%2FSamejima.Mamimi.600.204041.jpg&f=1&nofb=1&ipt=deada2201acce8cf74ea6f7125d1c31efd8a72abf61bd2d29f4042167548461d", caption:"resting" },
  { src:"https://external-content.duckduckgo.com/iu/?u=https%3A%2F%2Fwallup.net%2Fwp-content%2Fuploads%2F2017%2F10%2F25%2F485897-FLCL-Samejima_Mamimi.jpg&f=1&nofb=1&ipt=6c607319b4151b4d60063bb86970ca1beb092ce230f34df8e45a603c965b87d2", caption:"smile" },
  { src:"https://external-content.duckduckgo.com/iu/?u=https%3A%2F%2Fstatic.zerochan.net%2FSamejima.Mamimi.full.4146732.jpg&f=1&nofb=1&ipt=22d1328d25d49caff69cc6c909c2dd7fa8943b02b5936cb6bc7dd3db95804dd0", caption:"im conflicted" },
  { src:"https://external-content.duckduckgo.com/iu/?u=https%3A%2F%2Fi.pinimg.com%2Foriginals%2F57%2F01%2F16%2F57011645ae878045aebe898e89c69e71.jpg&f=1&nofb=1&ipt=32d2af6e860ef7e2edd925441d8a45c1a7a67b9470ea54f8bda71dcabecdf745", caption:"alone" },
  { src:"https://external-content.duckduckgo.com/iu/?u=https%3A%2F%2Fstatic.zerochan.net%2FSamejima.Mamimi.full.4146590.jpg&f=1&nofb=1&ipt=8482c15523762cb8000868d50f085108ea3627e289df76e11fae2340a092e82e", caption:"blaze" },
  { src:"https://external-content.duckduckgo.com/iu/?u=https%3A%2F%2Fstatic.zerochan.net%2FFLCL.full.4025888.jpg&f=1&nofb=1&ipt=37e8f28bca8bbaeb27e7a8459bad13a9fa88a50fdc24eb0815c17bb39c70e5b2", caption:"together" },
  { src:"https://external-content.duckduckgo.com/iu/?u=https%3A%2F%2Fimg10.reactor.cc%2Fpics%2Fpost%2Ffull%2FKR0NPR1NZ-flcl-Anime-Samejima-Mamimi-1953718.jpeg&f=1&nofb=1&ipt=5ed0f0a9df23bf5b36733977404ad6292c454db5af2b1531cbeee4c3bba2ca5b", caption:"protection" },
  { src:"https://external-content.duckduckgo.com/iu/?u=https%3A%2F%2Fkonachan.com%2Fimage%2Fac211c3447f1d62f5600880edf84d4bd%2FKonachan.com%2520-%252045831%2520flcl%2520gainax%2520samejima_mamimi.jpg&f=1&nofb=1&ipt=929f604c51077f716d083c90561dbb8472510d851f6272b98d43f61ebe7d61fc", caption:"edge" },
  { src:"https://external-content.duckduckgo.com/iu/?u=https%3A%2F%2Fcdn.donmai.us%2Fsample%2Ff1%2F95%2F__samejima_mamimi_flcl_drawn_by_sukuyo_onaka__sample-f1955c52caf04720cda77602fbd6a020.jpg&f=1&nofb=1&ipt=21a0a130d1a7cda9d002d1c7defacf34b9f6ba08270c44c97033f3b7567dbd92p", caption:"hiding" },
  { src:"https://external-content.duckduckgo.com/iu/?u=https%3A%2F%2Fstatic.zerochan.net%2FFLCL.full.2549159.jpg&f=1&nofb=1&ipt=5bf9d52ef43f541fdc5717933e5176df9f566726fa7f4814473ac86297fcca05", caption:"ownership" },
  { src:"https://external-content.duckduckgo.com/iu/?u=https%3A%2F%2Ftse1.mm.bing.net%2Fth%2Fid%2FOIP.4nQjdJyuGkqJLeKBqnmBEQHaF7%3Fcb%3Ducfimgc2%26pid%3DApi&f=1&ipt=81af026a9412f8a75cbaf37cd00598a2f3f686857ffe5b31208c932a4f0d6701", caption:"god" },
  { src:"https://external-content.duckduckgo.com/iu/?u=https%3A%2F%2Fcdn.donmai.us%2Fsample%2F9e%2F96%2F__samejima_mamimi_and_ninamori_eri_flcl_drawn_by_dentedhood__sample-9e960cbc7624bcaf7090a14d95a1c936.jpg&f=1&nofb=1&ipt=176a4cfaf3a81a1556d1ec38581a416c98a427357de41d05e45a14951d46af72", caption:"opposites" },
  { src:"https://external-content.duckduckgo.com/iu/?u=https%3A%2F%2Fcdn.donmai.us%2Foriginal%2Fe9%2F74%2F__samejima_mamimi_flcl_drawn_by_kanoko_y__e974e24d54fec5659ea7a1ef857dd555.png&f=1&nofb=1&ipt=d0511fb56b39eb74baa01cb9e3eacb9937d8ccb6984ace46cf8c4fb5a4a8b4fb", caption:"abandon" },
  { src:"https://external-content.duckduckgo.com/iu/?u=https%3A%2F%2Fcdn.donmai.us%2Foriginal%2Fb4%2F6c%2F__samejima_mamimi_flcl_drawn_by_souupbox__b46c5704273f7b5911229fb20454b93c.jpg&f=1&nofb=1&ipt=4e9a1209956a912722e1a18f728751f6fb2f73f513dc38660109606c2b975fdc", caption:"messy" },
  { src:"https://external-content.duckduckgo.com/iu/?u=https%3A%2F%2Fcdn.donmai.us%2Fsample%2F31%2F02%2F__samejima_mamimi_and_canti_flcl_drawn_by_4th_chaos_emerald__sample-31020707c8167a10876e1a0d74f47f78.jpg&f=1&nofb=1&ipt=a96e00781270ac923dc0c8752f49afb102213eefdd09eff568bf917331678374", caption:"alive" },
  { src:"https://external-content.duckduckgo.com/iu/?u=https%3A%2F%2Fcdn.donmai.us%2Foriginal%2F7c%2Fe6%2F__samejima_mamimi_flcl_drawn_by_monlopolo__7ce659abcac41b633625cc887729559c.jpg%3Fdownload%3D1&f=1&nofb=1&ipt=73d0c86d4da51bc40b75f2939988f3f9c463832dcbdccc743e62800bbe9f4b7cg", caption: "rebirth" },
  {src:"https://external-content.duckduckgo.com/iu/?u=https%3A%2F%2Fcdn.donmai.us%2Foriginal%2Fe3%2Fb2%2F__samejima_mamimi_and_takkun_flcl_drawn_by_monlopolo__e3b27c0ac777d6502b19450d113e80f4.jpg&f=1&nofb=1&ipt=efbacd4c24ee86b77f10abb6fb52b482109018f9c7e218f314d555abbcc7fcc0", caption:"friendship" },
  {src:"https://external-content.duckduckgo.com/iu/?u=https%3A%2F%2Fimg10.reactor.cc%2Fpics%2Fpost%2Fpantsu-ripper-Samejima-Mamimi-%25D0%25A4%25D1%2583%25D1%2580%25D0%25B8%25D0%25BA%25D1%2583%25D1%2580%25D0%25B8-Anime-6419630.jpeg&f=1&nofb=1&ipt=27ddc630f0d43ee79aa5c7edf68f9a7015b7af1f8f8f474680fe98d0eb6b3a1c", caption:"homeless" },
  {src:"https://external-content.duckduckgo.com/iu/?u=https%3A%2F%2Fi.pinimg.com%2Foriginals%2Fc5%2Fee%2Fdb%2Fc5eedbc9a2f6a564313ffed4786166bb.jpg&f=1&nofb=1&ipt=5f7a4f00c635c4e117df643d0467af7ef67b8ea618d42e4d307f15455ed72859", caption:"prayer" },
  {src:"https://external-content.duckduckgo.com/iu/?u=https%3A%2F%2Fi.pinimg.com%2F736x%2F6a%2F7f%2F76%2F6a7f7650e20e282884621dce30a110f1.jpg&f=1&nofb=1&ipt=80df8012df8a30c449424ddfe95a3ef2d7f657badf6468309f1694bb12f92a99", caption:"clouds"},
  {src:"https://external-content.duckduckgo.com/iu/?u=https%3A%2F%2Fcdn.donmai.us%2Foriginal%2Fd5%2F2e%2F__samejima_mamimi_and_boogiepop_flcl_and_1_more_drawn_by_pantsu_ripper__d52ed97e78a39e7f7c5d9829a35b1bba.jpg%3Fdownload%3D1&f=1&nofb=1&ipt=e313d644317df92a0bf4962c980888933e0949eac8de113ebb7b090b12c104c7", caption: "wizards"},
  {src:"https://external-content.duckduckgo.com/iu/?u=https%3A%2F%2Fcdn.donmai.us%2Fsample%2F93%2Fa2%2F__samejima_mamimi_flcl_drawn_by_halemary__sample-93a2033387c2931ec2c2ca8e968d9232.jpg&f=1&nofb=1&ipt=23ac28d4dbaa6a3714c6081265a5ec3b7805017cd71452fe2c395a75192770a0", caption:"disappointment"},
  {src:"https://external-content.duckduckgo.com/iu/?u=https%3A%2F%2Fcdn.donmai.us%2Fsample%2Fba%2F88%2F__samejima_mamimi_flcl_drawn_by_menma_enaic31__sample-ba8825c1b685eeb7357406d74c2868a4.jpg&f=1&nofb=1&ipt=3bc14a15908a9cb296d8836b027f748583f0019d2731d8c543218a8da9176beb", caption: "invincible"},
  {src:"https://external-content.duckduckgo.com/iu/?u=https%3A%2F%2Fcdn.donmai.us%2Foriginal%2Fbd%2F8c%2F__samejima_mamimi_and_takkun_flcl_drawn_by_lcr_comics__bd8c027315ce161da936af6cb892d5f9.jpg%3Fdownload%3D1&f=1&nofb=1&ipt=70a0ff6f4ad4f6ac33754bcfa3fe9fe35bfc25c9a2d0e1d984acff6651fdd4bc", caption: "distracted"},
  {src:"https://cdn.bsky.app/img/feed_fullsize/plain/did:plc:fpm2upyjl6llbawtfnesxqou/bafkreieriraem6rkquxozffsccsatmiy2irhx5amrcupge6xuenxumltbu@jpeg", caption: "melancholy"},
  {src:"https://glamours.eorzeacollection.com/65432/mamimi-samejima-cosplay-1-1608023240.png", caption:"property"},
  {src:"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcS-giL-idKNdTVojll1-NowGM8egAp8gpbqCg&s", caption:"temptation"},
  {src:"https://art.ngfiles.com/images/5868000/5868441_993342_fimboll_mamimi-and-lord-canti.ebf8e342f723c13fa8028fe7c7edb37f.jpg?f1720892372", caption:"end the world"},
  {src:"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTGpjYrqJV3mPbWIC22W8NqC33dky6l7zsm4A&s", caption:"beauty"},
  {src:"https://i.pinimg.com/736x/78/e3/d0/78e3d0dd98850bddcfb503667bb4d72f.jpg", caption:"feeling alive"},
  {src:"https://safebooru.org//samples/4358/sample_eed99a06c83986eeb325e12cc36e6f98a0025ddd.jpg?4547491", caption:"difference"},
  {src:"https://safebooru.org/thumbnails/2052/thumbnail_07f55f3dc02dedc0a972c35892f3a395563ec230.jpg?5410152", caption:"embarassing"},
  {src:"https://art.ngfiles.com/images/2458000/2458199_nettx0_mamimi-has-a-youtube-channel.jpg?f1649817635", caption:"unwanted"},
  {src:"https://i.pinimg.com/originals/ea/8c/0e/ea8c0ed08b3aba5568dcd2f2a482bb7b.gif", caption:"vision"},
  {src:"https://64.media.tumblr.com/5c17b37df25e8bdd61793f7011cd4903/f7f9160f2aad5b3a-a8/s2048x3072/8d56cd869870c43d2c9e3f5fcb65ad8ccb04fa26.pnj", caption:"swing the bat"},
  {src:"https://i.pinimg.com/170x/f9/c2/8f/f9c28f495570efa5c647a3ad3b165eb2.jpg", caption:"sliced bread"},
  {src:"https://i.redd.it/mh8gspcoxe1c1.png", caption:"freedom"},
  {src:"https://i.pinimg.com/236x/a3/d7/7a/a3d77a579f6f3210b7199342a8e16a14.jpg", caption:"skibidi"},
  {src:"https://i.pinimg.com/236x/38/e9/7d/38e97d7481f7f50f70485c2ff9daa3df.jpg", caption:"溢れちゃう"},
  {src:"https://i.pinimg.com/564x/02/c3/cd/02c3cdecaaf6774b947c72af545915d3.jpg", caption:"ehhh"},
  {src:"https://ih1.redbubble.net/image.2430883344.8345/flat,750x,075,f-pad,750x1000,f8f8f8.jpg", caption:"beginning"},
  {src:"https://animesher.com/orig/0/32/325/3254/animesher.com_flcl-manga-fooly-cooly-325489.gif", caption:"fleeting"},
  {src:"https://25.media.tumblr.com/tumblr_mdybotk6E91rtr9gvo1_500.gif", caption:"fear"},
  {src:"https://i.pinimg.com/736x/22/89/f8/2289f809fa501c99f68153f1f6908f8b.jpg", caption:"relief"},
  {src:"https://pbs.twimg.com/media/FMh2YUbXMAYZ1pY.png", caption:"天使"},
  {src:"https://media.tenor.com/vPGeXuAdIgQAAAAe/flcl-mamimi.png", caption:"tranquility"},
  {src:"https://i.pinimg.com/236x/ff/8f/ca/ff8fca3c880be9a30887db85ea43c415.jpg", caption:"team"},
  {src:"https://i.pinimg.com/474x/0c/82/86/0c8286116bd26cdb3b9d9029e8638e98.jpg", caption:"curiosity"},
  {src:"https://ih1.redbubble.net/image.780577479.0185/bg,f8f8f8-flat,750x,075,f-pad,750x1000,f8f8f8.jpg", caption:"mystery"},
  {src:"https://64.media.tumblr.com/af8872737979574679fbbc59053f5ef6/71debf48b2f2790f-fa/s540x810/5f5166d0344163713284d530a477f471706905a7.pnj", caption:"source"},
  {src:"https://pbs.twimg.com/media/G3MVz4nXIAEkk2I?format=jpg&name=large", caption:"love"},
  {src:"https://pbs.twimg.com/media/Gv7Z2IgXsAIGFbD?format=jpg&name=large", caption:"unlikely friendship"},
  {src:"https://external-content.duckduckgo.com/iu/?u=https%3A%2F%2Fcdn.donmai.us%2Foriginal%2F34%2F7f%2F__samejima_mamimi_and_nandaba_naota_flcl_drawn_by_haruhara_haruhara_0628__347fb403940372eccb458ec090c127dc.jpg%3Fdownload%3D1&f=1&nofb=1&ipt=6c30841f46d8785a2e55284b9b3c56820e2402326d71120825af66e0997cbb4a", caption:"possessive"},
  {src:"https://external-content.duckduckgo.com/iu/?u=https%3A%2F%2Fcdn.donmai.us%2Fsample%2F35%2Fb7%2F__samejima_mamimi_and_takkun_flcl_drawn_by_inktaru__sample-35b720433e8c7fcdf57658aad45e1f41.jpg&f=1&nofb=1&ipt=c9767831f5652f9669b7ee5e95cf3bf6cf2f535cae77c59880af8c592bae643d", caption:"paronoia"},
  {src:"https://external-content.duckduckgo.com/iu/?u=https%3A%2F%2Fcdn.donmai.us%2Fsample%2F25%2F2e%2F__samejima_mamimi_and_nandaba_naota_flcl_drawn_by_sano_snsk3470__sample-252edaf2d3f9f1fe8c35073ac6333905.jpg&f=1&nofb=1&ipt=bc5f83528f29d4ef2a8ef084bae1d14b005e6c8867172ea4da46919f7b47cc35", caption:"connection"},
  {src:"https://external-content.duckduckgo.com/iu/?u=https%3A%2F%2Fcdn.donmai.us%2Fsample%2F58%2Fdc%2F__samejima_mamimi_flcl_drawn_by_monlopolo__sample-58dc7a4612de4fbb713178bfd7d3f033.jpg&f=1&nofb=1&ipt=9f5098fc65d28e933a5dbf46a0dbb868ada33ae8e3951ff459a74f214c699b14", caption:"isolation"},
  {src:"https://external-content.duckduckgo.com/iu/?u=https%3A%2F%2Fimg10.reactor.cc%2Fpics%2Fpost%2FMamimi-Samejima-Anime-flcl-Samejima-Mamimi-3473058.jpeg&f=1&nofb=1&ipt=f9030f4efc579bb96708719d0d8a8ae5b8600b9ff2ffcfb9bc295905828e68a2", caption:"standing tall"},
  {src:"https://external-content.duckduckgo.com/iu/?u=https%3A%2F%2Fcdn.donmai.us%2Foriginal%2F28%2F95%2F__haruhara_haruko_samejima_mamimi_and_nandaba_naota_flcl_drawn_by_albinosun__289566f3c84c7377caa9307727e40656.jpg%3Fdownload%3D1&f=1&nofb=1&ipt=f2a7a973c140015740070daf71ca762362eb5e709084e5b9ae8882d874378962", caption:"im dragged along"},
  {src:"https://external-content.duckduckgo.com/iu/?u=https%3A%2F%2Fcdn.donmai.us%2Fsample%2F4d%2F97%2F__samejima_mamimi_flcl_drawn_by_kuga_hotaru__sample-4d970ce63047578738e2fcb99fe91c1e.jpg&f=1&nofb=1&ipt=533d1be4f9f608ac1ced5fa542870d7b8ebedf0521961f4142589032086bbcf9", caption:"warming up"},
  {src:"https://external-content.duckduckgo.com/iu/?u=https%3A%2F%2Fcdn.donmai.us%2Fsample%2Fbb%2Ff0%2F__samejima_mamimi_flcl_drawn_by_subfiction__sample-bbf0ef3acac6af5189d17e8ab5de6f9c.jpg&f=1&nofb=1&ipt=de230b939c3eb62503caa9a5981ea9f05148392eb6c52515e82aa43e74ad36db", caption:"takkun"},
  {src:"https://external-content.duckduckgo.com/iu/?u=https%3A%2F%2Fcdn.donmai.us%2Fsample%2Feb%2F86%2F__samejima_mamimi_flcl_drawn_by_omh204__sample-eb86f6da4c5cc810c664b16a9d782e01.jpg&f=1&nofb=1&ipt=258b1a95935c251f40ded8cd1058f377a5a5c36eb11112654a2c2ea76c147120", caption:"street"},
  {src:"https://external-content.duckduckgo.com/iu/?u=https%3A%2F%2Fcdn.donmai.us%2Foriginal%2Fe2%2Fde%2F__samejima_mamimi_flcl_drawn_by_semham__e2de63ef0f822aaeace722624913dd9d.jpg&f=1&nofb=1&ipt=3fadd70866384f9a987363d00eb15b8fe9453c2192c55500628b3d233d875989", caption:"urban exploration"},
  {src:"https://external-content.duckduckgo.com/iu/?u=https%3A%2F%2Fimg10.joyreactor.com%2Fpics%2Fpost%2Ffull%2FFLCL-anime-fandoms-3473085.jpeg&f=1&nofb=1&ipt=58e783a9b99fd2bfadbb463f5b9a4c56c208b66a9111a72d31c578140bb8a738", caption:"breaking dimensions"},
  {src:"https://external-content.duckduckgo.com/iu/?u=https%3A%2F%2Fimg10.joyreactor.com%2Fpics%2Fpost%2Ffull%2Fnaota-Mamimi-Samejima-FLCL-3007318.jpeg&f=1&nofb=1&ipt=386331073a48e48e91f03bfd5f66afa575ca293cb1a82ed45ff86ba5b28eb224", caption:"different days"},
  {src:"https://external-content.duckduckgo.com/iu/?u=https%3A%2F%2Fimg10.joyreactor.com%2Fpics%2Fpost%2Ffull%2Fpantsu-ripper-Samejima-Mamimi-FLCL-5784761.jpeg&f=1&nofb=1&ipt=7403199d476e478ebc503a464192c42b4ecef03d52653c070c0a37ec5cc41c36", caption:"youth"},
  {src:"https://external-content.duckduckgo.com/iu/?u=https%3A%2F%2Fstatic.zerochan.net%2FFLCL.full.4173095.jpg&f=1&nofb=1&ipt=379802f017daee179a007b18a9db42744a66025e63fdd26daa555ad22336f481", caption:"showcase"},
  {src:"https://external-content.duckduckgo.com/iu/?u=https%3A%2F%2Fcdn.donmai.us%2Fsample%2Ffe%2Fed%2F__samejima_mamimi_and_takkun_flcl_drawn_by_menma_enaic31__sample-feedad3d9d236620056cae4a5df2f643.jpg&f=1&nofb=1&ipt=c69a1c546d3f49c5338135c4a86483da246303a7d374461481312587bada7d52", caption:"same"},
  {src:"https://external-content.duckduckgo.com/iu/?u=https%3A%2F%2Fcdn.donmai.us%2Foriginal%2F7c%2F35%2F__samejima_mamimi_flcl_drawn_by_mi_zukii3__7c35ee5b2587a4d560401729b998cca7.jpg&f=1&nofb=1&ipt=466e5de4981a21ca5527ba64fd4b9ffd4239761f79b9b4b89d9492c0e92a4433", caption:"relapse"},
  {src:"https://images-wixmp-ed30a86b8c4ca887773594c2.wixmp.com/f/4bbe8074-2a1d-460c-a989-3a573b6014cb/db2blca-13546aaa-2d2e-4678-9ebc-717f67d15c97.png/v1/fit/w_828,h_1254,q_70,strp/mamimi_by_sgtmadness_db2blca-414w-2x.jpg?token=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJ1cm46YXBwOjdlMGQxODg5ODIyNjQzNzNhNWYwZDQxNWVhMGQyNmUwIiwiaXNzIjoidXJuOmFwcDo3ZTBkMTg4OTgyMjY0MzczYTVmMGQ0MTVlYTBkMjZlMCIsIm9iaiI6W1t7ImhlaWdodCI6Ijw9MTQyMCIsInBhdGgiOiIvZi80YmJlODA3NC0yYTFkLTQ2MGMtYTk4OS0zYTU3M2I2MDE0Y2IvZGIyYmxjYS0xMzU0NmFhYS0yZDJlLTQ2NzgtOWViYy03MTdmNjdkMTVjOTcucG5nIiwid2lkdGgiOiI8PTkzNyJ9XV0sImF1ZCI6WyJ1cm46c2VydmljZTppbWFnZS5vcGVyYXRpb25zIl19.Kes4pvmPtOQK4aAWzDjux6JIt7ZP9m1P9q6Jlx4dRmc", caption:"vulnerability"},
  {src:"https://images-wixmp-ed30a86b8c4ca887773594c2.wixmp.com/f/2b8f1d70-6fb7-4328-a69c-89b4fe331a7e/db5w3uc-bedef977-3704-42ee-8821-a3f0520f36c2.jpg/v1/fill/w_1024,h_768,q_75,strp/mamimi_samejima_by_sinichkina_db5w3uc-fullview.jpg?token=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJ1cm46YXBwOjdlMGQxODg5ODIyNjQzNzNhNWYwZDQxNWVhMGQyNmUwIiwiaXNzIjoidXJuOmFwcDo3ZTBkMTg4OTgyMjY0MzczYTVmMGQ0MTVlYTBkMjZlMCIsIm9iaiI6W1t7ImhlaWdodCI6Ijw9NzY4IiwicGF0aCI6Ii9mLzJiOGYxZDcwLTZmYjctNDMyOC1hNjljLTg5YjRmZTMzMWE3ZS9kYjV3M3VjLWJlZGVmOTc3LTM3MDQtNDJlZS04ODIxLWEzZjA1MjBmMzZjMi5qcGciLCJ3aWR0aCI6Ijw9MTAyNCJ9XV0sImF1ZCI6WyJ1cm46c2VydmljZTppbWFnZS5vcGVyYXRpb25zIl19.y6JVfb6ng4AMlb4XX98kej6mArQO7dtC7PFPgyfyQs4", caption:"im real"},
  {src:"https://images-wixmp-ed30a86b8c4ca887773594c2.wixmp.com/f/1a3c6e7c-80db-43a3-90d2-070bbdffa77f/de18v4a-f9b2a906-c031-448f-9e72-09685397810d.png/v1/fill/w_1192,h_670,q_70,strp/samejima_mamimi_by_saintsan_de18v4a-pre.jpg?token=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJ1cm46YXBwOjdlMGQxODg5ODIyNjQzNzNhNWYwZDQxNWVhMGQyNmUwIiwiaXNzIjoidXJuOmFwcDo3ZTBkMTg4OTgyMjY0MzczYTVmMGQ0MTVlYTBkMjZlMCIsIm9iaiI6W1t7ImhlaWdodCI6Ijw9NzIwIiwicGF0aCI6Ii9mLzFhM2M2ZTdjLTgwZGItNDNhMy05MGQyLTA3MGJiZGZmYTc3Zi9kZTE4djRhLWY5YjJhOTA2LWMwMzEtNDQ4Zi05ZTcyLTA5Njg1Mzk3ODEwZC5wbmciLCJ3aWR0aCI6Ijw9MTI4MCJ9XV0sImF1ZCI6WyJ1cm46c2VydmljZTppbWFnZS5vcGVyYXRpb25zIl19.MDofWdGhpg0UOGMfyrXrGvTl4NoOE7e7v59ygHIsT2E", caption:"secrets"},
  {src:"https://images-wixmp-ed30a86b8c4ca887773594c2.wixmp.com/f/1a3c6e7c-80db-43a3-90d2-070bbdffa77f/de5w95w-bcaed3c9-26bc-42ae-b896-6c26314ee24e.png/v1/fill/w_1192,h_670,q_70,strp/samejima_mamimi_by_saintsan_de5w95w-pre.jpg?token=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJ1cm46YXBwOjdlMGQxODg5ODIyNjQzNzNhNWYwZDQxNWVhMGQyNmUwIiwiaXNzIjoidXJuOmFwcDo3ZTBkMTg4OTgyMjY0MzczYTVmMGQ0MTVlYTBkMjZlMCIsIm9iaiI6W1t7ImhlaWdodCI6Ijw9NzIwIiwicGF0aCI6Ii9mLzFhM2M2ZTdjLTgwZGItNDNhMy05MGQyLTA3MGJiZGZmYTc3Zi9kZTV3OTV3LWJjYWVkM2M5LTI2YmMtNDJhZS1iODk2LTZjMjYzMTRlZTI0ZS5wbmciLCJ3aWR0aCI6Ijw9MTI4MCJ9XV0sImF1ZCI6WyJ1cm46c2VydmljZTppbWFnZS5vcGVyYXRpb25zIl19.ttimJHjJtqjk6o5dkvREPYsl98kzUaZXFmiIj7VUFGY", caption:"melancholic"},
  {src:"https://images-wixmp-ed30a86b8c4ca887773594c2.wixmp.com/f/a538ed5c-72e0-4123-9a2c-b80bb046ea53/d8nwy31-8c2c6567-9f52-46c6-bb18-2c33d49de70c.jpg/v1/fit/w_828,h_1072,q_70,strp/invaders_must_die_by_ghostpai_d8nwy31-414w-2x.jpg?token=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJ1cm46YXBwOjdlMGQxODg5ODIyNjQzNzNhNWYwZDQxNWVhMGQyNmUwIiwiaXNzIjoidXJuOmFwcDo3ZTBkMTg4OTgyMjY0MzczYTVmMGQ0MTVlYTBkMjZlMCIsIm9iaiI6W1t7ImhlaWdodCI6Ijw9Mzg1MCIsInBhdGgiOiIvZi9hNTM4ZWQ1Yy03MmUwLTQxMjMtOWEyYy1iODBiYjA0NmVhNTMvZDhud3kzMS04YzJjNjU2Ny05ZjUyLTQ2YzYtYmIxOC0yYzMzZDQ5ZGU3MGMuanBnIiwid2lkdGgiOiI8PTI5NzUifV1dLCJhdWQiOlsidXJuOnNlcnZpY2U6aW1hZ2Uub3BlcmF0aW9ucyJdfQ.5Wl069X9pcomIQe_UclV7GJ_sJW2y2qzr2Seye_r7w8", caption:"invaders"},
  {src:"https://images-wixmp-ed30a86b8c4ca887773594c2.wixmp.com/f/29dd86e4-eb7f-48c3-97e6-0b6912ef5a11/dayqdjt-7ea90ea8-68c8-4062-8415-79fa6dbf1192.jpg/v1/fill/w_1041,h_768,q_70,strp/mamimi_process_by_carmenbezombe_dayqdjt-pre.jpg?token=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJ1cm46YXBwOjdlMGQxODg5ODIyNjQzNzNhNWYwZDQxNWVhMGQyNmUwIiwiaXNzIjoidXJuOmFwcDo3ZTBkMTg4OTgyMjY0MzczYTVmMGQ0MTVlYTBkMjZlMCIsIm9iaiI6W1t7ImhlaWdodCI6Ijw9MTE3OSIsInBhdGgiOiIvZi8yOWRkODZlNC1lYjdmLTQ4YzMtOTdlNi0wYjY5MTJlZjVhMTEvZGF5cWRqdC03ZWE5MGVhOC02OGM4LTQwNjItODQxNS03OWZhNmRiZjExOTIuanBnIiwid2lkdGgiOiI8PTE1OTkifV1dLCJhdWQiOlsidXJuOnNlcnZpY2U6aW1hZ2Uub3BlcmF0aW9ucyJdfQ.i4NsO5K1kov56o-zk8Pynagt2BQBh2TOKgutvOpATKQ", caption:"process"},
  {src:"https://images-wixmp-ed30a86b8c4ca887773594c2.wixmp.com/f/29dd86e4-eb7f-48c3-97e6-0b6912ef5a11/dc2s1fl-b0ce139a-6388-46b8-b152-b0d9c594986a.jpg/v1/fit/w_828,h_1172,q_70,strp/princess_bubblegum_by_carmenbezombe_dc2s1fl-414w-2x.jpg?token=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJ1cm46YXBwOjdlMGQxODg5ODIyNjQzNzNhNWYwZDQxNWVhMGQyNmUwIiwiaXNzIjoidXJuOmFwcDo3ZTBkMTg4OTgyMjY0MzczYTVmMGQ0MTVlYTBkMjZlMCIsIm9iaiI6W1t7ImhlaWdodCI6Ijw9MjI2MyIsInBhdGgiOiIvZi8yOWRkODZlNC1lYjdmLTQ4YzMtOTdlNi0wYjY5MTJlZjVhMTEvZGMyczFmbC1iMGNlMTM5YS02Mzg4LTQ2YjgtYjE1Mi1iMGQ5YzU5NDk4NmEuanBnIiwid2lkdGgiOiI8PTE2MDAifV1dLCJhdWQiOlsidXJuOnNlcnZpY2U6aW1hZ2Uub3BlcmF0aW9ucyJdfQ.npimdIY-e5VxffNup5uJpORd_rMox_2rhdYlCQJnnhg", caption:"princess"},
  {src:"https://images-wixmp-ed30a86b8c4ca887773594c2.wixmp.com/f/decf19d3-b654-476b-a1ae-20566dab2310/ddne6ly-22be40a5-a90b-43ef-949f-6c003fd09ea2.jpg/v1/fill/w_894,h_894,q_70,strp/mamimi_and_takkun__by_l4kes_ddne6ly-pre.jpg?token=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJ1cm46YXBwOjdlMGQxODg5ODIyNjQzNzNhNWYwZDQxNWVhMGQyNmUwIiwiaXNzIjoidXJuOmFwcDo3ZTBkMTg4OTgyMjY0MzczYTVmMGQ0MTVlYTBkMjZlMCIsIm9iaiI6W1t7ImhlaWdodCI6Ijw9MTk2MSIsInBhdGgiOiIvZi9kZWNmMTlkMy1iNjU0LTQ3NmItYTFhZS0yMDU2NmRhYjIzMTAvZGRuZTZseS0yMmJlNDBhNS1hOTBiLTQzZWYtOTQ5Zi02YzAwM2ZkMDllYTIuanBnIiwid2lkdGgiOiI8PTE5NjAifV1dLCJhdWQiOlsidXJuOnNlcnZpY2U6aW1hZ2Uub3BlcmF0aW9ucyJdfQ.2hk5vf0rGqMHxRMtgmByDcCHDsvDvf6bVJ9pthkoSWI", caption:"kiss"},
  {src:"https://embed.pixiv.net/artwork.php?illust_id=108346800&mdate=1684740771", caption:"contemplation"},
  {src:"images/samejimawallpaper.png", caption:"pablo"},

];

  /* {src:"", caption:""}, */

  /* ===========================
     1) Elements & state
     =========================== */
  const scrollport = document.getElementById('scrollport');
  const world      = document.getElementById('world');
  const floor      = document.getElementById('floor');

  let WORLD_W = 0, WORLD_H = 0;
  let zCounter = 10;

  const rand = (min, max)=> Math.random()*(max-min)+min;
  const lerp = (a,b,t)=> a+(b-a)*t;

  /* ===========================
     2) World sizing & centering
     =========================== */
  function measureWorld(){
    WORLD_W = world.offsetWidth;
    WORLD_H = world.offsetHeight;
  }
  function centerCamera(){
    const x = Math.max(0, (WORLD_W - scrollport.clientWidth)/2);
    const y = Math.max(0, (WORLD_H - scrollport.clientHeight)/2);
    scrollport.scrollTo({ left:x, top:y });
  }

  /* ===========================
   Realistic Scatter Generator (Soft Poisson)
   =========================== */
function scatteredPoints(width, height, baseDist, overlapFactor = 0.45, maxAttempts = 20) {
  const points = [];
  const minDist = baseDist * overlapFactor;
  const maxDist = baseDist * 1.2;

  // add first point near center
  points.push({ 
    x: width / 2 + (Math.random() - 0.5) * width * 0.2,
    y: height / 2 + (Math.random() - 0.5) * height * 0.2
  });

  while (points.length < IMAGES.length && maxAttempts > 0) {
    let tries = 0, valid = false, p = null;
    while (!valid && tries < maxAttempts) {
      const angle = Math.random() * Math.PI * 2;
      const dist = minDist + Math.random() * (maxDist - minDist);
      const ref = points[Math.floor(Math.random() * points.length)];
      const x = ref.x + Math.cos(angle) * dist;
      const y = ref.y + Math.sin(angle) * dist;
      if (x < 0 || y < 0 || x > width || y > height) { tries++; continue; }

      // only reject if *too close* (tight cluster tolerance)
      valid = points.every(pt => {
        const dx = pt.x - x, dy = pt.y - y;
        return dx*dx + dy*dy > (minDist * 0.6) ** 2;
      });
      if (valid) p = {x, y};
      tries++;
    }
    if (p) points.push(p); else break;
  }

  return points;
}

/* ===========================
   3) Build polaroids (no pile-up) 
   =========================== */
const placedRects = [];

function makePolaroid({src, caption=""}) {
  if (!src) return;

  const el = document.createElement('figure');
  el.className = 'polaroid';
  el.dataset.rot = `${rand(-20, 20).toFixed(2)}deg`;
  el.style.zIndex = String(zCounter++);
  el.innerHTML = `
    <img src="${src}" alt="${caption || 'polaroid'}" loading="lazy" decoding="async" />
    <figcaption class="caption">${caption}</figcaption>
  `;

  floor.appendChild(el);

  requestAnimationFrame(() => positionRandomNoOverlap(el));
  enablePointerDrag(el);
}

function positionRandomNoOverlap(el) {
  const pad = 100;
  const w = el.offsetWidth;
  const h = el.offsetHeight;

  let tries = 0, x = 0, y = 0;
  const maxTries = 100;
  const centerX = WORLD_W / 2;
  const centerY = WORLD_H / 2;
  const spreadRadius = Math.min(WORLD_W, WORLD_H) / 3;

  do {
    const angle = rand(0, Math.PI * 2);
    const radius = rand(0, spreadRadius);
    x = centerX + Math.cos(angle) * radius;
    y = centerY + Math.sin(angle) * radius;
    x = Math.max(pad, Math.min(WORLD_W - w - pad, x));
    y = Math.max(pad, Math.min(WORLD_H - h - pad, y));
    tries++;
  } while (overlaps(x, y, w, h) && tries < maxTries);

  el.dataset.x = x;
  el.dataset.y = y;
  applyTransform(el);

  placedRects.push({x, y, w, h});
}

function overlaps(x, y, w, h) {
  const gutter = 24;
  for (const r of placedRects) {
    if (x < r.x + r.w + gutter &&
        x + w + gutter > r.x &&
        y < r.y + r.h + gutter &&
        y + h + gutter > r.y) return true;
  }
  return false;
}

/* ===========================
   4) Pointer-based dragging (GPU-optimized)
   =========================== */
function enablePointerDrag(el) {
  let startX = 0, startY = 0;
  let startElX = 0, startElY = 0;
  let dragging = false;

  // Ensure transform layer exists (important for Firefox)
  el.style.transform = el.style.transform || 'translate3d(0,0,0)';
  el.style.willChange = 'transform';

  const onDown = (e) => {
    if (e.button !== undefined && e.button !== 0) return; // only left click
    e.preventDefault();

    bringToFront(el);
    dragging = true;

    startX = e.pageX;
    startY = e.pageY;
    startElX = parseFloat(el.dataset.x || '0');
    startElY = parseFloat(el.dataset.y || '0');

    el.classList.add('dragging');

    // Attach listeners to the document (bypasses Firefox pointer capture bug)
    document.addEventListener('pointermove', onMove, { passive: false });
    document.addEventListener('pointerup', onUp);
    document.addEventListener('pointercancel', onUp);
  };

  const onMove = (e) => {
    if (!dragging) return;
    e.preventDefault(); // stop scrolling/touch gestures

    const dx = e.pageX - startX;
    const dy = e.pageY - startY;

    const newX = Math.max(0, Math.min(WORLD_W - el.offsetWidth, startElX + dx));
    const newY = Math.max(0, Math.min(WORLD_H - el.offsetHeight, startElY + dy));

    el.dataset.x = newX;
    el.dataset.y = newY;
    applyTransform(el);
  };

  const onUp = () => {
    if (!dragging) return;
    dragging = false;
    el.classList.remove('dragging');

    document.removeEventListener('pointermove', onMove);
    document.removeEventListener('pointerup', onUp);
    document.removeEventListener('pointercancel', onUp);
  };

  el.addEventListener('pointerdown', onDown);
}


function bringToFront(el) {
  el.style.zIndex = String(zCounter++);
}

/* ===========================
   Transform helper
   =========================== */
function applyTransform(el) {
  const x = parseFloat(el.dataset.x || '0');
  const y = parseFloat(el.dataset.y || '0');
  const rot = el.dataset.rot || '0deg';
  el.style.transform = `translate3d(${x}px, ${y}px, 0) rotate(${rot})`;
}


  /* ===========================
     5) Mouse tilt
     =========================== */
  let targetRX=0, targetRY=0, curRX=0, curRY=0;

  window.addEventListener('mousemove', (e)=>{
    // const rect = scrollport.getBoundingClientRect();
    // const nx = ((e.clientX - rect.left)/rect.width)*2 - 1;
    // const ny = ((e.clientY - rect.top)/rect.height)*2 - 1;
    // targetRX = ny * -6;
    // targetRY = nx *  6;
  });

/* === Animate: tilt + idle drift === */
let driftT = 0;

function animate(){
  driftT += 0.002; // adjust for faster or slower breathing motion
  const idleRX = Math.sin(driftT) * 1.2;
  const idleRY = Math.cos(driftT) * 1.2;

  curRX = lerp(curRX, targetRX + idleRX, 0.06);
  curRY = lerp(curRY, targetRY + idleRY, 0.06);

  floor.style.transform = `rotateX(${curRX}deg) rotateY(${curRY}deg) translateZ(0)`;
  requestAnimationFrame(animate);
}


  /* ===========================
     6) Keyboard panning (WASD + Arrows)
     =========================== */
  (function enableKeyboardPan(){
    const speed = 28;
    const boost = 1.9;
    const pressed = new Set();
    let raf = null;

    function wantsPanKey(k){
      return ['ArrowUp','ArrowDown','ArrowLeft','ArrowRight',' ','Spacebar','w','a','s','d','W','A','S','D','Shift'].includes(k);
    }

    window.addEventListener('keydown', (e)=>{
      if (wantsPanKey(e.key)) e.preventDefault();
      pressed.add(e.key);
      if (!raf) raf = requestAnimationFrame(step);
    }, {capture:true});

    window.addEventListener('keyup', (e)=>{
      pressed.delete(e.key);
      if (pressed.size===0 && raf){ cancelAnimationFrame(raf); raf=null; }
    });

    function step(){
      let dx=0, dy=0;
      const fast = pressed.has('Shift') ? boost : 1;
      if (pressed.has('a')||pressed.has('A')||pressed.has('ArrowLeft'))  dx -= speed*fast;
      if (pressed.has('d')||pressed.has('D')||pressed.has('ArrowRight')) dx += speed*fast;
      if (pressed.has('w')||pressed.has('W')||pressed.has('ArrowUp'))    dy -= speed*fast;
      if (pressed.has('s')||pressed.has('S')||pressed.has('ArrowDown'))  dy += speed*fast;
      if (dx||dy) scrollport.scrollBy({ left:dx, top:dy, behavior:'auto' });
      if (pressed.size>0) raf = requestAnimationFrame(step); else raf=null;
    }

    // Space = recenter
    window.addEventListener('keydown', (e)=>{
      if ((e.key===' ' || e.key==='Spacebar') && !e.ctrlKey && !e.metaKey && !e.altKey){
        e.preventDefault(); centerCamera();
      }
    }, {capture:true});
  })();

  /* ===========================
     7) Init
     =========================== */
  function init(){
     measureWorld();
  const pad = 200;
  const points = scatteredPoints(WORLD_W - pad * 2, WORLD_H - pad * 2, 340);

  IMAGES.slice(0, points.length).forEach((img, i) => {
    const p = points[i];
    makePolaroid({
      ...img,
      x: p.x + pad + rand(-30, 30), // jitter
      y: p.y + pad + rand(-30, 30)
    });
  });

  requestAnimationFrame(centerCamera);
  requestAnimationFrame(animate);

    // keep inside on resize
window.addEventListener('resize', () => {
  measureWorld();
  const pad = 10;
  document.querySelectorAll('.polaroid').forEach(el => {
    const w = el.offsetWidth, h = el.offsetHeight;
    let x = parseFloat(el.dataset.x || '0');
    let y = parseFloat(el.dataset.y || '0');
    x = Math.max(pad, Math.min(WORLD_W - w - pad, x));
    y = Math.max(pad, Math.min(WORLD_H - h - pad, y));
    el.dataset.x = x;
    el.dataset.y = y;
    applyTransform(el);
  });
});

  }

  init();
});
</script>
</body>
</html>
